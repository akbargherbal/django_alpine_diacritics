{% extends 'diacriticizer/base.html' %}
{% load static %}

{% block custom_stylesheets %}
<link rel="stylesheet" href="{% static 'diacriticizer/css/diacriticize.css' %}"/>
{% endblock %}



{% block page_title %}
Arabic Text Diacritization
{% endblock %}

{% block content %}
<main dir="rtl">
    <!-- Navigation -->
    <nav class="navbar">
        <div class="navbar-brand">
            <h1 class="logo">تَشْكِيل</h1>
        </div>
        <div class="nav-links">
            <a href="{% url 'diacriticizer:home' %}" class="nav-link">Home</a>
            <a href="/guide" class="nav-link">Guide</a>
            <a href="/about" class="nav-link">About</a>
        </div>
    </nav>

    <!-- Main Content Area -->
    <div class="container" x-data="sentHook" tabindex="0" :class="{'edit-mode': isEditMode, 'autopilot-mode': isAutoPilot}">
        <!-- Text Area - Wrapped in div for HTMX target -->
        <div id="text-content" 
             class="text-content-wrapper">
            <div class="verse" 
                 data-tokens-count="{{ tokens_count }}"
                 data-dia-count="{{ total_diacritics }}"
                 data-mode="{{ mode }}">
                {{ verse|safe }}
            </div>

            <!-- Hidden JSON data that will also be updated -->
            {{ wd_dict|json_script:"wd_dict" }}
            {{ char_dict_global|json_script:"char_dict_global" }}
            {{ char_dict_local|json_script:"char_dict_local" }}
        </div>

        <!-- Mode and Controls -->
        <div class="control-panel">
            <div class="mode-indicator">
                <span>Current Mode:</span>
                <span class="mode-display" x-text="isEditMode ? 'Edit Mode' : (isAutoPilot ? 'Auto-pilot' : 'Normal')"></span>
            </div>
            <button class="next-sentence-btn"
            hx-get="{% url 'diacriticizer:next-sentence' %}?mode={{ mode }}"
            hx-target="#text-content"
            hx-swap="innerHTML"
            hx-trigger="click"
            hx-indicator=".loading-indicator">
        Next Sentence
            </button>
            <span class="loading-indicator" style="display:none">Loading...</span>
        </div>

        <!-- Stats Display -->
        <div class="stats-panel">
            <div class="diacritic-display">
                <span>الحركة: </span>
                <span x-text="currentChar"></span>
            </div>
        </div>
    </div>
</main>
{% endblock content %}